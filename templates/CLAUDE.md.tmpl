# {{PROJECT_NAME}} — Legio Orchestration

> Auto-generated by `legio init`. You may edit this file.

This project uses **legio** for Claude Code agent orchestration. Your session
acts as the orchestrator: you decide what work to delegate, spawn worker agents,
monitor progress, and merge results.

## Quick Reference

```bash
# Spawn a worker agent
legio sling <bead-id> --capability <type> --name <agent-name> \
  [--spec <path>] [--files file1,file2] [--parent <agent>] [--depth <n>]

# Check system status
legio status              # Overview of all agents, worktrees, beads
legio status --json       # Machine-readable output
legio status --watch      # Live updating

# Messaging (SQLite-backed, ~1-5ms per query)
legio mail send --to <agent> --subject "..." --body "..."
legio mail check          # Your inbox
legio mail list --unread  # All unread messages
legio mail reply <id> --body "..."

# Merge completed work
legio merge --branch <name>   # Merge a specific branch
legio merge --all             # Merge all completed branches
legio merge --dry-run --branch <name>  # Preview conflicts

# Worktree management
legio worktree list       # Show all worktrees with status
legio worktree clean --completed  # Remove finished worktrees

# Context and monitoring
legio prime               # Reload context (config, mulch, recent activity)
legio watch --background  # Start watchdog daemon
legio metrics             # Performance summary
legio log <event> --agent <name>  # Hook-driven event logging
```

## How to Spawn Agents

1. Identify the work using beads: `bd ready` or `bd create "task title"`
2. Choose a capability based on the task:
{{AGENT_DEFINITIONS}}
3. Assign exclusive file scope so agents do not conflict
4. Spawn: `legio sling <bead-id> --capability <type> --name <unique-name> --files src/foo.ts,src/bar.ts`

Each spawned agent gets its own git worktree, branch, CLAUDE.md overlay, and
tmux session. Agents communicate via `legio mail` and report completion
by closing their beads issue (`bd close <id> --reason "summary"`).

## Hierarchical Delegation

You can spawn **team leads** that themselves spawn sub-workers:

```
Orchestrator (this session)
  └── legio sling bd-xyz --capability lead --name build-lead
        ├── legio sling bd-abc --capability builder --name auth-login
        ├── legio sling bd-def --capability builder --name auth-signup
        └── legio sling bd-ghi --capability builder --name auth-reset
```

Depth limit is configurable (default: 2). Leads use `--parent` and `--depth`
to track hierarchy.

## Checking Status

Run `legio status` to see:
- Active agents and their states (booting, working, stalled, zombie)
- Worktree locations and branches
- Beads issue progress
- Unread mail count

## Canonical Branch

All merges target **{{CANONICAL_BRANCH}}**. Agents work on branches named
`legio/<agent-name>/<bead-id>`. Never push directly to {{CANONICAL_BRANCH}}.

## Conventions

- Agents own files exclusively — no two agents modify the same file
- Use `legio mail` for all inter-agent communication (not beads)
- Use `bd close` to report task completion (not mail)
- Merge via `legio merge`, not raw `git merge`
- Logs live in `.legio/logs/` — never delete them manually
